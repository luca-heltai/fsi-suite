<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fluid structure interaction suite: Continuum mechanics and fluid-structure interaction problems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fluid structure interaction suite
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Continuum mechanics and fluid-structure interaction problems </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Lecture materials for the course "Continuum mechanics and fluid-structure
interaction problems: mathematical modeling and numerical approximation"</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Author</b> </td><td class="markdownTableBodyNone">Luca Heltai <a href="#" onclick="location.href='mai'+'lto:'+'luc'+'a.'+'hel'+'ta'+'i@s'+'is'+'sa.'+'it'; return false;">luca.<span style="display: none;">.nosp@m.</span>helt<span style="display: none;">.nosp@m.</span>ai@si<span style="display: none;">.nosp@m.</span>ssa.<span style="display: none;">.nosp@m.</span>it</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>GitHub Repository:</b> </td><td class="markdownTableBodyNone"><a href="https://github.com/luca-heltai/fsi-suite">https://github.com/luca-heltai/fsi-suite</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GitHub Pages:</b> </td><td class="markdownTableBodyNone"><a href="https://luca-heltai.github.io/fsi-suite/">https://luca-heltai.github.io/fsi-suite/</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Licence:</b> </td><td class="markdownTableBodyNone">see the file LICENCE.md  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md7"></a>
Course Introduction</h1>
<p>Fluid-structure interaction (FSI) refers to the multiphysics coupling between the laws that describe fluid dynamics and structural mechanics.</p>
<p>This page collects the material that I have used for a course given at Kaust (<a href="https://www.kaust.edu.sa/en">https://www.kaust.edu.sa/en</a>) during the spring semester of 2022.</p>
<p>The course covers three main topics: i) basics of continuum mechanics, ii) mathematical modeling of FSI problems, and iii) numerical implementations based on the finite element method. Theoretical lectures are backed up by applied laboratories based on the C++ language, using example codes developed with the open source finite element library deal.II (www.dealii.org). I cover basic principles of continuum mechanics, discuss Lagrangian, Eulerian, and Arbitrary Lagrangian-Eulerian formulations, and cover different coupling strategies, both from the theoretical point of view, and with the aid of computational laboratories.</p>
<p>The students will learn how to develop, use, and analyze state-of-the-art finite element approximations for the solution of continuum mechanics problems, including non-linear mechanics, computational fluid dynamics, and fluid-structure-interaction problems.</p>
<p>A glimpse of the <a class="el" href="namespace_p_d_es.html" title="We collect in this namespace all PDEs that are relevant to Fluid Structure Interaction Problems.">PDEs</a> that are discussed in the course is given by the following graph</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_serial.svg" width="1508" height="490"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<p><object type="image/svg+xml" data="./doc/dot_files/serial.svg" style="pointer-events: none;"></object></p>
<p>The laboratory part should enable a PhD student working on numerical analysis of <a class="el" href="namespace_p_d_es.html" title="We collect in this namespace all PDEs that are relevant to Fluid Structure Interaction Problems.">PDEs</a> to implement state-of-the-art adaptive finite element codes for FSI problems, that run in parallel, using modern C++ libraries. The implementation are based on the <code>deal.II</code> library (www.dealii.org).</p>
<p>Main topics covered by these lectures:</p>
<ul>
<li>Advanced Finite Element theory</li>
<li>How to use a modern C++ IDE, to build and debug your codes</li>
<li>How to use a large FEM library to solve complex PDE problems</li>
<li>How to properly document your code using Doxygen</li>
<li>How to use a proper Git workflow to develop your applications</li>
<li>How to leverage GitHub actions, google tests, and docker images to test and deploy your application</li>
<li>How hybrid parallelisation (threads + MPI + GPU) works in real life FEM applications</li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
Continuous Integration Status</h1>
<p>Up to date online documentation for the codes used in the laboratories is here:</p>
<p><a href="https://luca-heltai.github.io/fsi-suite/">https://luca-heltai.github.io/fsi-suite/</a></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">System </th><th class="markdownTableHeadNone">Status  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Continous Integration</b> </td><td class="markdownTableBodyNone"><a href="https://github.com/luca-heltai/fsi-suite/actions/workflows/tests.yml"><object type="image/svg+xml" data="https://github.com/luca-heltai/fsi-suite/actions/workflows/tests.yml/badge.svg" style="pointer-events: none;">GitHub CI</object></a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Docker</b> </td><td class="markdownTableBodyNone"><a href="https://github.com/luca-heltai/fsi-suite/actions/workflows/docker.yml"><object type="image/svg+xml" data="https://github.com/luca-heltai/fsi-suite/actions/workflows/docker.yml/badge.svg" style="pointer-events: none;">github-docker</object></a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Doxygen</b> </td><td class="markdownTableBodyNone"><a href="https://github.com/luca-heltai/fsi-suite/actions/workflows/doxygen.yml"><object type="image/svg+xml" data="https://github.com/luca-heltai/fsi-suite/actions/workflows/doxygen.yml/badge.svg" style="pointer-events: none;">Doxygen</object></a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Indent</b> </td><td class="markdownTableBodyNone"><a href="https://github.com/luca-heltai/fsi-suite/actions/workflows/indentation.yml"><object type="image/svg+xml" data="https://github.com/luca-heltai/fsi-suite/actions/workflows/indentation.yml/badge.svg" style="pointer-events: none;">Indent</object></a>  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md9"></a>
Useful links</h1>
<p>One of my courses on theory and practice of finite elements:</p><ul>
<li><a href="https://www.math.sissa.it/course/phd-course/theory-and-practice-finite-element-methods">https://www.math.sissa.it/course/phd-course/theory-and-practice-finite-element-methods</a></li>
</ul>
<p>Exceptional video lectures by Prof. Wolfgang Bangerth, that cover all the things you will ever need for finite element programming.</p>
<ul>
<li><a href="https://www.math.colostate.edu/~bangerth/videos.html">https://www.math.colostate.edu/~bangerth/videos.html</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Quick start</h1>
<p>If you have Docker installed, you can run any of the programs available within this repository by executing the following commands: </p><pre class="fragment">wget https://raw.githubusercontent.com/luca-heltai/fsi-suite/main/fsi-suite.sh
chmod +x ./fsi-suite.sh
./fsi-suite.sh
</pre><p>you should see the following output: </p><pre class="fragment">Usage: ./fsi-suite.sh [-np N] program-name program-options

Will run program-name with program-options, possibly via mpirun, passing -np N to mpirun.
Here is a list of programs you can run:
linear_elasticity.g  mpi_stokes.g
distributed_lagrange    mesh_handler         poisson
distributed_lagrange.g  mesh_handler.g       poisson.g
dof_plotter     mpi_linear_elasticity    reduced_lagrange
dof_plotter.g       mpi_linear_elasticity.g  reduced_lagrange.g
fsi_test        mpi_poisson      stokes
fsi_test.g      mpi_poisson.g        stokes.g
linear_elasticity   mpi_stokes

Programs ending with .g are compiled with debug symbols. To see help on how to run
any of the programs, add a -h flag at the end.
</pre><p>The above command will download the latest docker image from the <code>main</code> branch of this repository (which is built and uploaded to <a href="https://hub.docker.com/r/heltai/fsi-suite">https://hub.docker.com/r/heltai/fsi-suite</a> at every commit to master), mount the current directory, in a directory with the same path inside the container, and the program you selected. For example, </p><pre class="fragment">./fsi-suite.sh -np 4 mpi_poisson.g
</pre><p>will run the (debug version of the) executable based on the <a class="el" href="class_p_d_es_1_1_m_p_i_1_1_poisson.html" title="Solve the Poisson problem, in parallel.">PDEs::MPI::Poisson</a> problem in parallel, using 4 processors. You can change grid, boundary conditions, forcing terms, finite element spaces, etc. by editing the configuration file which is created the first time you run the program, and then passing it as an argument to the program itself, i.e., in the example above, the parameter file that would be generated is <code>used_mpi_poisson.g_2d.prm</code>, which you can edit and then pass as input to the program itself: </p><pre class="fragment">./fsi-suite.sh -np 4 mpi_poisson.g used_mpi_poisson.g_2d.prm
</pre><p>If you want to read some documentation of what each parameter does and how it works, you can call the program passing a non-existing parameter file : </p><pre class="fragment">./fsi-suite.sh -np 4 mpi_poisson.g my_test.prm

----------------------------------------------------
Exception on processing: 

--------------------------------------------------------
An error occurred in line &lt;77&gt; of file &lt;../source/base/parameter_acceptor.cc&gt; in function
    static void ParameterAcceptor::initialize(const string&amp;, const string&amp;, ParameterHandler::OutputStyle, ParameterHandler&amp;, ParameterHandler::OutputStyle)
The violated condition was: 
    false
Additional information: 
    You specified &lt;my_test.prm&gt; as input parameter file, but it does not
    exist. We created it for you.
</pre><p>The created parameter file will also contain documentation for each parameter. Running again the same command will now use the parameter file that was just created: </p><pre class="fragment">./fsi-suite.sh -np 4 mpi_poisson.g my_test.prm

Number of cores         : 8
Number of threads       : 2
Number of MPI processes : 4
MPI rank of this process: 0
Cycle 0
System setup
Number of dofs 4
Number of degrees of freedom: 4 (4)
cells dofs  u_L2_norm   u_H1_norm  
    1    4 0.000e+00 - 0.000e+00 - 


+---------------------------------------------+------------+------------+
| Total CPU time elapsed since start          |      0.07s |            |
|                                             |            |            |
| Section                         | no. calls |  CPU time  | % of total |
+---------------------------------+-----------+------------+------------+
| assemble_system                 |         1 |  0.000425s |      0.61% |
| estimate                        |         1 |  0.000434s |      0.62% |
| output_results                  |         1 |   0.00591s |       8.4% |
| setup_system                    |         1 |    0.0124s |        18% |
| solve                           |         1 |   0.00547s |       7.8% |
+---------------------------------+-----------+------------+------------+
</pre> <h1><a class="anchor" id="autotoc_md11"></a>
Course program</h1>
<p>A tentative detailed program is shown below (this will be updated during the course to reflect the actual course content)</p>
<ol type="1">
<li>Course introduction.<ul>
<li>Motivating examples</li>
<li>Basic principles and background knowledge.</li>
</ul>
</li>
<li>Recap on Finite Element Methods<ul>
<li>Introduction to deal.II.</li>
</ul>
</li>
<li>Basic principles of continuum mechanics<ul>
<li>conservation equations</li>
<li>constitutive equations</li>
<li>kinematics</li>
<li>transport theorems</li>
</ul>
</li>
</ol>
<ol type="1">
<li>Lagrangian formulation of continuum mechanics (solids).<ul>
<li>Static and compressible linear elasticity</li>
</ul>
</li>
<li>Recap on mixed problems<ul>
<li>Static incompressible linear elasticity</li>
</ul>
</li>
<li>Eulerian formulation of continuum mechanics<ul>
<li>Stokes problem</li>
</ul>
</li>
<li>Recap on time discretization schemes<ul>
<li>Time dependent Stokes problem</li>
<li>Time dependent linear elasticity (wave equations)</li>
</ul>
</li>
<li>Treating non-linearities<ul>
<li>IMEX</li>
<li>predictor corrector</li>
<li>fixed point</li>
<li>Newton</li>
</ul>
</li>
<li>Navier-Stokes equations</li>
<li>Segregated coupling<ul>
<li>Lagrangian domain deformation</li>
</ul>
</li>
<li>Arbitrary Lagrangian Eulerian formulation</li>
<li>Immersed Boundary/Immersed Finite Element Method</li>
<li>Distributed Lagrange multiplier formulation</li>
<li>Students' projects. </li>
</ol>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Apr 27 2022 12:07:49 for Fluid structure interaction suite by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
